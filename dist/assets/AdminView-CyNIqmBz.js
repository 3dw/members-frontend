import{r as o,o as T,a as C,s as v,b as h,V as y,e as f,W as U,X as _,g as r,h as t,m as c,F as P,j as M,w as u,v as m,i as j,p as q,k as a,t as w,_ as A}from"./index-DioPGc-t.js";const I={props:{uid:{type:String,required:!0},user:{type:Object,required:!0}},setup(){const l=o([]),e=o("理事會"),s=o(""),i=o(""),g=o(""),d=o([]),n=o(""),b=o([]),E=o(""),x=o(""),V=o(""),N=o(""),S=o(""),D=o(!1),R=o({}),F=o({}),B=o(""),O=o("");return T(()=>{C(_,k=>{const p=k.val();console.log(p),l.value=Object.values(p)}),C(U,k=>{const p=k.val();console.log(p),b.value=Object.values(p)})}),{supervisors:l,action:e,newName:s,newRole:i,newEmail:g,members:d,password:n,projects:b,newProjectName:E,newProjectMainCategory:x,newProjectMaintainer:V,newProjectMaintainerEmail:N,newProjectDescription:S,editMode:D,currentProject:R,currentSupervisor:F,newUserFullname:B,newUserEmail:O}},methods:{addSupervisor(l,e,s){const i=this.supervisors.length;v(h(f,`supervisors/${i}`),{id:i,fullname:l,role:e,email:s})},listMembers(l){console.log(l);const e=l||window.prompt("請輸入密碼");e&&(l||(this.password=e),y.post("https://members-backend.alearn13994229.workers.dev/get_user_list",{uid:this.uid,password:e}).then(s=>{this.members=s.data}).catch(s=>{console.error("讀取會員資料時出錯",s)}))},addUser(){const l=this.newUserFullname,e=this.newUserEmail,s=window.prompt("請輸入密碼");s&&y.post("https://members-backend.alearn13994229.workers.dev/add_user",{uid:this.uid,password:s,fullname:l,email:e}).then(i=>{i.status===200?(window.alert("新增成功"),this.listMembers(this.password)):window.alert("新增失敗")}).catch(i=>{console.error("新增會員資料時出錯",i)})},deleteUser(l){const e=window.prompt("請輸入密碼");e&&window.confirm("確定要刪除嗎？")&&y.post("https://members-backend.alearn13994229.workers.dev/delete_user",{uid:this.uid,password:e,email:l}).then(s=>{s.status===200?(window.alert("刪除成功"),this.listMembers(this.password)):window.alert("刪除失敗")}).catch(s=>{console.error("刪除會員資料時出錯",s)})},addProject(){const l=this.projects.length;v(h(f,`projects/${l}`),{id:l,full_name:this.newProjectName,main_category:this.newProjectMainCategory,maintainer:this.newProjectMaintainer,maintainer_email:this.newProjectMaintainerEmail,description:this.newProjectDescription})},editProject(l){this.newProjectName=l.full_name,this.newProjectMainCategory=l.main_category,this.newProjectMaintainer=l.maintainer,this.newProjectMaintainerEmail=l.maintainer_email,this.newProjectDescription=l.description,this.editMode=!0,this.currentProject=l},updateProject(l){v(h(f,`projects/${l.id}`),{id:l.id,full_name:this.newProjectName,main_category:this.newProjectMainCategory,maintainer:this.newProjectMaintainer,maintainer_email:this.newProjectMaintainerEmail,description:this.newProjectDescription}).then(()=>{window.alert("更新成功"),this.editMode=!1}).catch(e=>{console.error("更新失敗",e),window.alert("更新失敗")})},deleteProject(l){if(window.confirm("確定要刪除嗎？")){const e=this.projects.filter(s=>s.id!==l.id);v(U,e).then(()=>{window.alert("刪除成功")}).catch(s=>{console.error("刪除失敗",s),window.alert("刪除失敗")})}},editSupervisor(l){this.newName=l.fullname,this.newRole=l.role,this.newEmail=l.email,this.editMode=!0,this.currentSupervisor=l},updateSupervisor(l){v(h(f,`supervisors/${l.id}`),{id:l.id,fullname:this.newName,role:this.newRole,email:this.newEmail}).then(()=>{window.alert("更新成功"),this.editMode=!1}).catch(e=>{console.error("更新失敗",e),window.alert("更新失敗")})},deleteSupervisor(l){const e=this.supervisors.filter(s=>s.id!==l.id);v(_,e).then(()=>{window.alert("刪除成功")}).catch(s=>{console.error("刪除失敗",s),window.alert("刪除失敗")})}}},L={key:0,class:"ui segment container"},W={class:"ui menu"},X={key:0,class:"ui segment"},z={class:"ui segment"},G={key:0,class:"ui celled compact table"},H={class:"ui vertical buttons"},J=["onClick"],K={key:1,class:"ui segment"},Q={class:"ui celled compact table"},Y={class:"ui vertical buttons"},Z=["onClick"],$=["onClick"],ee={class:"ui form"},te={class:"ui field"},ne={class:"ui input"},ie={class:"ui field"},le={class:"ui input"},se={class:"ui field"},oe={class:"ui input"},re={key:2,class:"ui segment"},ae={class:"ui celled stackable table"},de=["href"],ue={class:"description"},ce={class:"ui vertical buttons"},me=["onClick"],we=["onClick"],be={class:"ui form"},ve={class:"ui field"},pe={class:"ui input"},he={class:"ui field"},fe={class:"ui input"},je={class:"ui field"},ke={class:"ui input"},ye={class:"ui field"},Pe={class:"ui input"},Me={class:"ui field"},ge={class:"ui input"},Ce={key:0,class:"plus icon"},Ue={key:1,class:"save icon"},_e={key:2},Ee={key:3},xe={key:1,class:"ui segment"};function Ve(l,e,s,i,g,d){return s.uid&&s.user&&s.user.isAdmin?(a(),r("main",L,[e[42]||(e[42]=t("h1",{class:"ui header"},"管理員系統",-1)),t("div",W,[t("button",{class:"item",onClick:e[0]||(e[0]=n=>i.action="會員管理")},"會員管理"),t("button",{class:"item",onClick:e[1]||(e[1]=n=>i.action="理監事會")},"理監事會"),t("button",{class:"item",onClick:e[2]||(e[2]=n=>i.action="專案管理")},"專案管理")]),i.action==="會員管理"?(a(),r("div",X,[e[22]||(e[22]=t("h2",{class:"ui header"},"會員管理",-1)),t("div",z,[t("button",{class:"ui basic primary button",onClick:e[3]||(e[3]=n=>d.listMembers(null))},e[18]||(e[18]=[t("i",{class:"users icon"},null,-1),c("列出所有會員")]))]),i.members.length>0?(a(),r("table",G,[e[21]||(e[21]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"電子郵件"),t("th",null,"動作")])],-1)),t("tbody",null,[(a(!0),r(P,null,M(i.members,n=>(a(),r("tr",null,[t("td",null,w(n.fullname),1),t("td",null,w(n.email),1),t("td",null,[t("div",H,[t("button",{class:"ui basic red button",onClick:b=>d.deleteUser(n.email)},e[19]||(e[19]=[t("i",{class:"trash icon"},null,-1),c("刪除")]),8,J)])])]))),256)),t("tr",null,[t("td",null,[u(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=n=>i.newUserFullname=n),placeholder:"請輸入姓名"},null,512),[[m,i.newUserFullname]])]),t("td",null,[u(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=n=>i.newUserEmail=n),placeholder:"請輸入電子郵件"},null,512),[[m,i.newUserEmail]])]),t("td",null,[t("button",{class:"ui basic green button",onClick:e[6]||(e[6]=(...n)=>d.addUser&&d.addUser(...n))},e[20]||(e[20]=[t("i",{class:"user add icon"},null,-1),c("新增")]))])])])])):j("",!0)])):j("",!0),i.action==="理監事會"?(a(),r("div",K,[e[31]||(e[31]=t("h2",{class:"ui header"},"理監事會",-1)),t("table",Q,[e[25]||(e[25]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"職位"),t("th",null,"電子郵件"),t("th",null,"動作")])],-1)),t("tbody",null,[(a(!0),r(P,null,M(i.supervisors,n=>(a(),r("tr",null,[t("td",null,w(n.fullname),1),t("td",null,w(n.role),1),t("td",null,w(n.email),1),t("td",null,[t("div",Y,[t("button",{class:"ui basic primary button",onClick:b=>d.editSupervisor(n)},e[23]||(e[23]=[t("i",{class:"edit icon"},null,-1),c("編輯")]),8,Z),t("button",{class:"ui basic red button",onClick:b=>d.deleteSupervisor(n)},e[24]||(e[24]=[t("i",{class:"trash icon"},null,-1),c("刪除")]),8,$)])])]))),256))])]),t("div",ee,[t("div",te,[e[26]||(e[26]=t("label",null,"姓名",-1)),t("div",ne,[u(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=n=>i.newName=n),placeholder:"請輸入理事會成員姓名"},null,512),[[m,i.newName]])])]),t("div",ie,[e[27]||(e[27]=t("label",null,"職位",-1)),t("div",le,[u(t("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=n=>i.newRole=n),placeholder:"請輸入理事會成員職位"},null,512),[[m,i.newRole]])])]),t("div",se,[e[28]||(e[28]=t("label",null,"電子郵件",-1)),t("div",oe,[u(t("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=n=>i.newEmail=n),placeholder:"請輸入理事會成員電子郵件"},null,512),[[m,i.newEmail]])])]),i.editMode?(a(),r("button",{key:1,class:"ui basic green button",onClick:e[11]||(e[11]=n=>d.updateSupervisor(i.currentSupervisor))},e[30]||(e[30]=[t("i",{class:"save icon"},null,-1),c("更新")]))):(a(),r("button",{key:0,class:"ui basic green button",onClick:e[10]||(e[10]=n=>d.addSupervisor(i.newName,i.newRole,i.newEmail))},e[29]||(e[29]=[t("i",{class:"user add icon"},null,-1),c("新增")])))])])):j("",!0),i.action==="專案管理"?(a(),r("div",re,[e[41]||(e[41]=t("h2",{class:"ui header"},"專案管理",-1)),u(t("table",ae,[e[35]||(e[35]=t("thead",null,[t("tr",null,[t("th",null,"全名"),t("th",null,"主要類別"),t("th",null,"維護者"),t("th",null,"電子郵件信箱"),t("th",{class:"description"},"描述"),t("th",null,"動作")])],-1)),t("tbody",null,[(a(!0),r(P,null,M(i.projects,n=>(a(),r("tr",{key:n.id},[t("td",null,[t("a",{href:n.website,target:"_blank",rel:"noopener noreferrer"},[e[32]||(e[32]=t("i",{class:"globe icon"},null,-1)),c(w(n.full_name),1)],8,de)]),t("td",null,w(n.main_category),1),t("td",null,w(n.maintainer),1),t("td",null,w(n.maintainer_email),1),t("td",ue,w(n.description),1),t("td",null,[t("div",ce,[t("button",{class:"ui basic primary button",onClick:b=>d.editProject(n)},e[33]||(e[33]=[t("i",{class:"edit icon"},null,-1),c("編輯")]),8,me),t("button",{class:"ui basic red button",onClick:b=>d.deleteProject(n)},e[34]||(e[34]=[t("i",{class:"trash icon"},null,-1),c("刪除")]),8,we)])])]))),128))])],512),[[q,!i.editMode]]),t("div",be,[t("div",ve,[e[36]||(e[36]=t("label",null,"全名",-1)),t("div",pe,[u(t("input",{type:"text","onUpdate:modelValue":e[12]||(e[12]=n=>i.newProjectName=n),placeholder:"請輸入專案全名"},null,512),[[m,i.newProjectName]])])]),t("div",he,[e[37]||(e[37]=t("label",null,"主要類別",-1)),t("div",fe,[u(t("input",{type:"text","onUpdate:modelValue":e[13]||(e[13]=n=>i.newProjectMainCategory=n),placeholder:"請輸入專案主要類別"},null,512),[[m,i.newProjectMainCategory]])])]),t("div",je,[e[38]||(e[38]=t("label",null,"維護者",-1)),t("div",ke,[u(t("input",{type:"text","onUpdate:modelValue":e[14]||(e[14]=n=>i.newProjectMaintainer=n),placeholder:"請輸入專案維護者"},null,512),[[m,i.newProjectMaintainer]])])]),t("div",ye,[e[39]||(e[39]=t("label",null,"電子郵件信箱",-1)),t("div",Pe,[u(t("input",{type:"text","onUpdate:modelValue":e[15]||(e[15]=n=>i.newProjectMaintainerEmail=n),placeholder:"請輸入專案維護者電子郵件"},null,512),[[m,i.newProjectMaintainerEmail]])])]),t("div",Me,[e[40]||(e[40]=t("label",null,"描述",-1)),t("div",ge,[u(t("input",{type:"text","onUpdate:modelValue":e[16]||(e[16]=n=>i.newProjectDescription=n),placeholder:"請輸入專案描述"},null,512),[[m,i.newProjectDescription]])])]),t("button",{class:"ui basic green button",onClick:e[17]||(e[17]=n=>i.editMode?d.updateProject(i.currentProject):d.addProject())},[i.editMode?(a(),r("i",Ue)):(a(),r("i",Ce)),i.editMode?(a(),r("span",Ee,"更新")):(a(),r("span",_e,"新增"))])])])):j("",!0)])):(a(),r("div",xe,e[43]||(e[43]=[t("h2",{class:"ui header"},"請先登入管理員帳號",-1)])))}const Se=A(I,[["render",Ve],["__scopeId","data-v-39e94256"]]);export{Se as default};
