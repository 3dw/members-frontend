import{_ as C,c as n,a as u,b as r,F as h,r as p,w as F,v as A,d as B,e as i,o,n as E,t as y,f as D,g as b}from"./index-BpPPOl2i.js";const v={data(){return{selectedAmount:"500",customAmount:500,mode:"donate-by-card",modes:["donate-by-card","donate-by-qrcode","donate-by-bank-transfer","donate-by-code"],merchantID:"3002607",returnURL:"https://members-backend.alearn13994229.workers.dev/donation_callback",checkMacValue:"",clientBackURL:window.location.origin+"/donate",orderResultURL:""}},async mounted(){this.orderResultURL=window.location.origin+"/donate_complete/"+this.merchantTradeNo,this.checkMacValue=await this.generateCheckMacValue()},computed:{donationAmount(){return this.selectedAmount==="custom"?this.customAmount:parseInt(this.selectedAmount)},merchantTradeNo(){return`DON${Date.now()}${Math.floor(Math.random()*1e3)}`},merchantTradeDate(){return new Date().toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/(\d+)\/(\d+)\/(\d+)/,"$1/$2/$3")}},watch:{async donationAmount(){this.checkMacValue=await this.generateCheckMacValue()}},methods:{parse(s){if(s==="donate-by-card")return"信用卡小額捐贈";if(s==="donate-by-bank-transfer")return"銀行匯款捐贈";if(s==="donate-by-qrcode")return"QR Code掃碼捐贈";if(s==="donate-by-code")return"愛心碼捐贈"},clearCustomAmount(){this.selectedAmount!=="custom"&&(this.customAmount=500)},async generateCheckMacValue(){const s={MerchantID:this.merchantID,MerchantTradeNo:this.merchantTradeNo,MerchantTradeDate:this.merchantTradeDate,PaymentType:"aio",TotalAmount:this.donationAmount,TradeDesc:"自主學習促進會捐款",ItemName:"捐款",ReturnURL:this.returnURL,ChoosePayment:"Credit",EncryptType:"1",ClientBackURL:this.clientBackURL,OrderResultURL:this.orderResultURL},e=Object.keys(s).sort(),d="pwFHCqoQZGmho4w6",c="EkRm7iFT261dpevs";let t="HashKey="+d;e.forEach(m=>{t+="&"+m+"="+s[m]}),t+="&HashIV="+c;let l=encodeURIComponent(t).toLowerCase();return l=l.replace(/%20/g,"+").replace(/%2d/g,"-").replace(/%5f/g,"_").replace(/%2e/g,".").replace(/%21/g,"!").replace(/%2a/g,"*").replace(/%28/g,"(").replace(/%29/g,")"),(await this.sha256(l)).toUpperCase()},sha256(s){const e=new TextEncoder().encode(s);return crypto.subtle.digest("SHA-256",e).then(d=>Array.from(new Uint8Array(d)).map(c=>c.toString(16).padStart(2,"0")).join(""))}}},k={class:"ui segment container"},g={class:"ui header"},_={key:0},f={key:1},R={key:2},T={key:3},w={class:"ui vertical buttons"},U=["onClick"],L={key:0,method:"post",action:"https://payment-stage.ecpay.com.tw/Cashier/AioCheckOut/V5",target:"_blank"},M={class:"ui form"},V={class:"ui two stackable fields"},I={class:"compact field"},N={key:0,class:"field"},x=["value"],S=["value"],q=["value"],H=["value"],O=["value"],P=["value"],Q=["value"],K=["value"],j={key:1,class:"ui divider"},z={key:2,class:"ui segment"},G={key:3,class:"ui segment"},W={key:4,class:"ui segment"},Z={key:5,class:"ui divider"},J={key:6,class:"ui segment"};function X(s,e,d,c,t,l){return o(),n("div",k,[u("h2",g,[e[3]||(e[3]=u("span",null,[u("i",{class:"dollar icon"})],-1)),t.mode==="donate-by-card"?(o(),n("span",_,"信用卡小額捐贈")):t.mode==="donate-by-qrcode"?(o(),n("span",f,"QR Code掃碼捐贈")):t.mode==="donate-by-bank-transfer"?(o(),n("span",R,"銀行匯款捐贈")):t.mode==="donate-by-code"?(o(),n("span",T,"愛心碼捐贈")):r("",!0),e[4]||(e[4]=u("span",null,"   ",-1)),u("div",w,[(o(!0),n(h,null,p(t.modes,a=>(o(),n("button",{class:E(["ui basic green large button",{active:t.mode===a}]),key:a,onClick:m=>t.mode=a},y(l.parse(a)),11,U))),128))])]),t.mode==="donate-by-card"?(o(),n("form",L,[u("div",M,[u("div",V,[u("div",I,[e[6]||(e[6]=u("label",null,"選擇捐贈金額",-1)),F(u("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.selectedAmount=a),onChange:e[1]||(e[1]=(...a)=>l.clearCustomAmount&&l.clearCustomAmount(...a))},e[5]||(e[5]=[u("option",{value:"500"},"新台幣500元",-1),u("option",{value:"1000"},"新台幣1000元",-1),u("option",{value:"2000"},"新台幣2000元",-1),u("option",{value:"custom"},"自訂金額",-1)]),544),[[A,t.selectedAmount]])]),t.selectedAmount==="custom"?(o(),n("div",N,[e[7]||(e[7]=u("label",null,"自訂金額：新台幣",-1)),F(u("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=a=>t.customAmount=a),min:"500",placeholder:"輸入金額"},null,512),[[B,t.customAmount,void 0,{number:!0}]])])):r("",!0)]),u("input",{type:"hidden",name:"MerchantID",value:t.merchantID},null,8,x),u("input",{type:"hidden",name:"MerchantTradeNo",value:l.merchantTradeNo},null,8,S),u("input",{type:"hidden",name:"MerchantTradeDate",value:l.merchantTradeDate},null,8,q),e[8]||(e[8]=u("input",{type:"hidden",name:"PaymentType",value:"aio"},null,-1)),u("input",{type:"hidden",name:"TotalAmount",value:l.donationAmount},null,8,H),e[9]||(e[9]=u("input",{type:"hidden",name:"TradeDesc",value:"自主學習促進會捐款"},null,-1)),e[10]||(e[10]=u("input",{type:"hidden",name:"ItemName",value:"捐款"},null,-1)),u("input",{type:"hidden",name:"ReturnURL",value:t.returnURL},null,8,O),e[11]||(e[11]=u("input",{type:"hidden",name:"ChoosePayment",value:"Credit"},null,-1)),e[12]||(e[12]=u("input",{type:"hidden",name:"EncryptType",value:"1"},null,-1)),u("input",{type:"hidden",name:"CheckMacValue",value:t.checkMacValue},null,8,P),u("input",{type:"hidden",name:"ClientBackURL",value:t.clientBackURL},null,8,Q),u("input",{type:"hidden",name:"OrderResultURL",value:t.orderResultURL},null,8,K),e[13]||(e[13]=u("button",{type:"submit",class:"ui basic green large button"},[u("i",{class:"dollar icon"}),i(" 捐贈 ")],-1))])])):r("",!0),t.mode==="donate-by-bank-transfer"?(o(),n("div",j)):r("",!0),t.mode==="donate-by-bank-transfer"?(o(),n("div",z,e[14]||(e[14]=[u("h3",null,[i("本會銀行帳戶： "),u("br"),i(" 台北富邦 士林分行（012） "),u("br"),i(" 帳號：30012-0000601 "),u("br"),i(" 戶名：社團法人中華民國自主學習促進會 ")],-1)]))):r("",!0),t.mode==="donate-by-qrcode"?(o(),n("div",G,e[15]||(e[15]=[u("img",{id:"#donate-qrcode",src:D,alt:"線上捐款"},null,-1),u("p",null,"請掃描上方 QR Code",-1)]))):r("",!0),t.mode==="donate-by-code"?(o(),n("div",W,e[16]||(e[16]=[u("h3",null,"以愛心碼「9806」捐助本會",-1),u("p",null,"本會是一個非營利組織，需要您的支持。",-1),u("p",null,"愛心碼取為「9806」，是因為最初成立的契機，在於1998~2006年的「台北市自主學習（中學六年一貫）實驗計畫」，本會第一代會員多是計畫中的親師生及關注計畫的學者賢達，別具意義。",-1),u("p",null,"邀請並歡迎大家未來在開立電子發票的商家購物時，可主動向店員要求使用愛心碼，說出捐贈碼9806，或出示條碼即可。發票若中獎，將會自動捐入本會！",-1),u("img",{id:"donate",src:b,alt:"愛心碼"},null,-1)]))):r("",!0),t.mode!=="donate-by-code"?(o(),n("div",Z)):r("",!0),t.mode!=="donate-by-code"?(o(),n("div",J,e[17]||(e[17]=[u("h3",null,[i("完成捐款後，請將以下資訊寄至本會行政室： "),u("a",{href:"mailto:alearn13994229@gmail.com"},"Email：alearn13994229@gmail.com")],-1),u("ul",null,[u("li",null,"捐款人姓名"),u("li",null,"聯絡電話"),u("li",null,"通訊地址"),u("li",null,"捐款金額"),u("li",null,"匯款帳號後五碼"),u("li",null,"指定支持的專案（可略）")],-1),u("p",null,"本會將開立捐款收據並寄回給您，可供節稅使用。",-1)]))):r("",!0)])}const $=C(v,[["render",X],["__scopeId","data-v-6ccb163d"]]);export{$ as default};
