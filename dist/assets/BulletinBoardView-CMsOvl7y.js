import{d as M,r as p,o as _,a as y,n as D,s as b,b as g,c as r,e as o,F as k,f as $,w as B,v as T,g as d,h as V,t as c,_ as x}from"./index-BfiDyWeV.js";const I=M({props:{uid:{required:!1,default:""},users:{required:!1,default:()=>({})}},setup(s){const e=p([{author:"Alice",uid:"123",date:"2025-03-18 10:00:00",text:"This is a great post!"},{author:"Bob",uid:"456",date:"2025-03-18 10:00:00",text:"I totally agree with Alice."}]),n=p(""),f=()=>{console.log(n.value),e.value.push({author:s.users[s.uid].name||"匿名",uid:s.uid||"123",date:new Date().toISOString(),text:n.value}),n.value="",b(g,e.value).then(()=>{console.log("留言成功")})},v=i=>{const t=new Date,a=new Date(i);if(isNaN(a.getTime()))return"無效日期";const l=t.getTime()-a.getTime(),u=Math.floor(l/1e3),h=Math.floor(l/(1e3*60)),m=Math.floor(l/(1e3*60*60)),w=Math.floor(l/(1e3*60*60*24));return u<60?u===0?"剛剛":`${u} 秒前`:h<60?`${h} 分鐘前`:m<24?`${m} 小時前`:`${w} 天前`};return _(()=>{console.log("mounted"),y(g,i=>{const t=i.val();console.log(t),e.value=t.map(a=>({author:a.author,uid:a.uid,date:a.date,text:a.text}))}),setInterval(async()=>{console.log("tick"),await D(),e.value=[...e.value]},60*1e3)}),{messages:e,newMessage:n,addMessage:f,parseDate:v}}}),N={class:"ui container two column stackable grid"},S={class:"ui comments flex-reverse column"},C={class:"content"},L=["src"],R={class:"author"},U={class:"metadata"},q={class:"date"},A={class:"text"},F={class:"ui form reply column"},E={class:"field"};function H(s,e,n,f,v,i){return d(),r("div",N,[o("div",S,[(d(!0),r(k,null,$(s.messages,(t,a)=>(d(),r("div",{class:"comment",key:a},[o("div",C,[s.users&&s.users[t.uid]&&s.users[t.uid].photoURL?(d(),r("img",{key:0,class:"ui avatar image",src:s.users[t.uid].photoURL},null,8,L)):V("",!0),o("div",R,c(t.author),1),o("div",U,[o("div",q,c(s.parseDate(t.date)),1)]),o("div",A,c(t.text),1)])]))),128))]),o("div",F,[e[3]||(e[3]=o("div",{class:"ui divider thin-only"},null,-1)),o("div",E,[e[2]||(e[2]=o("label",null,"輸入留言",-1)),B(o("textarea",{"onUpdate:modelValue":e[0]||(e[0]=t=>s.newMessage=t)},null,512),[[T,s.newMessage]])]),o("div",{class:"ui primary submit button",onClick:e[1]||(e[1]=(...t)=>s.addMessage&&s.addMessage(...t))},"留言")])])}const j=x(I,[["render",H],["__scopeId","data-v-0b76f523"]]);export{j as default};
