import{d as b,r as M,o as D,a as $,n as L,s as B,b as k,c as n,e as t,f,F as T,g as V,w as C,v as I,h as l,t as g,_ as N}from"./index-svhgGHUl.js";const S=b({props:{uid:{required:!1,default:""},users:{required:!1,default:()=>({})}},setup(e,{emit:s}){const i=M([{author:"Alice",uid:"123",date:"2025-03-18 10:00:00",text:"This is a great post!"},{author:"Bob",uid:"456",date:"2025-03-18 10:00:00",text:"I totally agree with Alice."}]),d=M(""),m=()=>{console.log(d.value),i.value.push({author:e.users[e.uid].name||"匿名",uid:e.uid||"123",date:new Date().toISOString(),text:d.value}),d.value="",B(k,i.value).then(()=>{console.log("留言成功")})},p=()=>{s("toggleLogin")},o=u=>{const r=new Date,a=new Date(u);if(isNaN(a.getTime()))return"無效日期";const c=r.getTime()-a.getTime(),v=Math.floor(c/1e3),h=Math.floor(c/(1e3*60)),w=Math.floor(c/(1e3*60*60)),y=Math.floor(c/(1e3*60*60*24));return v<60?v===0?"剛剛":`${v} 秒前`:h<60?`${h} 分鐘前`:w<24?`${w} 小時前`:`${y} 天前`};return D(()=>{console.log("mounted"),$(k,u=>{const r=u.val();console.log(r),i.value=r.map(a=>({author:a.author,uid:a.uid,date:a.date,text:a.text}))}),setInterval(async()=>{console.log("tick"),await L(),i.value=[...i.value]},60*1e3)}),{messages:i,newMessage:d,addMessage:m,parseDate:o,toggleLogin:p}}}),R={class:"ui container two column stackable grid"},U={key:0,class:"column"},q={class:"ui segment"},A={key:1,class:"ui comments flex-reverse column"},F={class:"content"},_=["src"],E={class:"author"},H={class:"metadata"},O={class:"date"},j={class:"text"},z={key:2,class:"ui form reply column"},G={class:"field"};function J(e,s,i,d,m,p){return l(),n("div",R,[e.uid?f("",!0):(l(),n("div",U,[t("div",q,[s[3]||(s[3]=t("div",{class:"ui header"},"留言板",-1)),s[4]||(s[4]=t("div",{class:"ui description"},"請先登入才能留言",-1)),s[5]||(s[5]=t("div",{class:"ui divider"},null,-1)),t("button",{class:"ui large green basic button",onClick:s[0]||(s[0]=(...o)=>e.toggleLogin&&e.toggleLogin(...o))},"登入")])])),e.uid?(l(),n("div",A,[(l(!0),n(T,null,V(e.messages,(o,u)=>(l(),n("div",{class:"comment",key:u},[t("div",F,[e.users&&e.users[o.uid]&&e.users[o.uid].photoURL?(l(),n("img",{key:0,class:"ui avatar image",src:e.users[o.uid].photoURL},null,8,_)):f("",!0),t("div",E,g(o.author),1),t("div",H,[t("div",O,g(e.parseDate(o.date)),1)]),t("div",j,g(o.text),1)])]))),128))])):f("",!0),e.uid?(l(),n("div",z,[s[7]||(s[7]=t("div",{class:"ui divider thin-only"},null,-1)),t("div",G,[s[6]||(s[6]=t("label",null,"輸入留言",-1)),C(t("textarea",{"onUpdate:modelValue":s[1]||(s[1]=o=>e.newMessage=o)},null,512),[[I,e.newMessage]])]),t("div",{class:"ui primary submit button",onClick:s[2]||(s[2]=(...o)=>e.addMessage&&e.addMessage(...o))},"留言")])):f("",!0)])}const P=N(S,[["render",J],["__scopeId","data-v-30d62465"]]);export{P as default};
