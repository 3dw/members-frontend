import{r,o as U,a as g,s as h,b,c as B,d as j,e as _,f as O,p as q,g as s,h as e,i as c,F as f,j as k,k as P,w as u,v as m,l as A,m as o,t as d,_ as F}from"./index-Die5n-m9.js";const T={props:{uid:{type:String,required:!0},user:{type:Object,required:!0}},setup(){const l=r([]),t=r("理事會"),w=r(""),i=r(""),M=r(""),a=r([]),n=r(""),v=r([]),C=r(""),N=r(""),x=r(""),S=r(""),E=r(""),V=r(!1),D=r({}),R=r({});return U(()=>{g(O,y=>{const p=y.val();console.log(p),l.value=Object.values(p)}),g(q,y=>{const p=y.val();console.log(p),v.value=Object.values(p)})}),{supervisors:l,action:t,newName:w,newRole:i,newEmail:M,members:a,password:n,projects:v,newProjectName:C,newProjectMainCategory:N,newProjectMaintainer:x,newProjectMaintainerEmail:S,newProjectDescription:E,editMode:V,currentProject:D,currentSupervisor:R}},methods:{addSupervisor(l,t,w){const i=this.supervisors.length;h(b(j,`supervisors/${i}`),{id:i,fullname:l,role:t,email:w})},listMembers(){const l=window.prompt("請輸入密碼");l&&B.post("https://members-backend.alearn13994229.workers.dev/get_user_list",{uid:this.uid,password:l}).then(t=>{this.members=t.data}).catch(t=>{console.error("讀取會員資料時出錯",t)})},addProject(){const l=this.projects.length;h(b(j,`projects/${l}`),{id:l,full_name:this.newProjectName,main_category:this.newProjectMainCategory,maintainer:this.newProjectMaintainer,maintainer_email:this.newProjectMaintainerEmail,description:this.newProjectDescription})},editProject(l){this.newProjectName=l.full_name,this.newProjectMainCategory=l.main_category,this.newProjectMaintainer=l.maintainer,this.newProjectMaintainerEmail=l.maintainer_email,this.newProjectDescription=l.description,this.editMode=!0,this.currentProject=l},updateProject(l){h(b(j,`projects/${l.id}`),{id:l.id,full_name:this.newProjectName,main_category:this.newProjectMainCategory,maintainer:this.newProjectMaintainer,maintainer_email:this.newProjectMaintainerEmail,description:this.newProjectDescription}).then(()=>{window.alert("更新成功"),this.editMode=!1}).catch(t=>{console.error("更新失敗",t),window.alert("更新失敗")})},deleteProject(l){window.confirm("確定要刪除嗎？")&&_(b(j,`projects/${l.id}`)).then(()=>{window.alert("刪除成功")}).catch(t=>{console.error("刪除失敗",t),window.alert("刪除失敗")})},editSupervisor(l){this.newName=l.fullname,this.newRole=l.role,this.newEmail=l.email,this.editMode=!0,this.currentSupervisor=l},updateSupervisor(l){h(b(j,`supervisors/${l.id}`),{id:l.id,fullname:this.newName,role:this.newRole,email:this.newEmail})},deleteSupervisor(l){_(b(j,`supervisors/${l.id}`))}}},I={key:0,class:"ui segment container"},L={class:"ui menu"},z={key:0,class:"ui segment"},G={class:"ui segment"},H={key:0,class:"ui celled compact table"},J={key:1,class:"ui segment"},K={class:"ui celled compact table"},Q={class:"ui vertical buttons"},W=["onClick"],X=["onClick"],Y={class:"ui form"},Z={class:"ui field"},$={class:"ui input"},ee={class:"ui field"},te={class:"ui input"},ne={class:"ui field"},ie={class:"ui input"},le={key:2,class:"ui segment"},se={class:"ui celled stackable table"},oe=["href"],re={class:"description"},ae={class:"ui vertical buttons"},de=["onClick"],ue=["onClick"],ce={class:"ui form"},me={class:"ui field"},we={class:"ui input"},ve={class:"ui field"},be={class:"ui input"},je={class:"ui field"},pe={class:"ui input"},he={class:"ui field"},Pe={class:"ui input"},ye={class:"ui field"},fe={class:"ui input"},ke={key:0,class:"plus icon"},Me={key:1,class:"save icon"},ge={key:2},_e={key:3},Ce={key:1,class:"ui segment"};function Ne(l,t,w,i,M,a){return w.uid&&w.user&&w.user.isAdmin?(o(),s("main",I,[t[37]||(t[37]=e("h1",{class:"ui header"},"管理員系統",-1)),e("div",L,[e("button",{class:"item",onClick:t[0]||(t[0]=n=>i.action="會員管理")},"會員管理"),e("button",{class:"item",onClick:t[1]||(t[1]=n=>i.action="理監事會")},"理監事會"),e("button",{class:"item",onClick:t[2]||(t[2]=n=>i.action="專案管理")},"專案管理")]),i.action==="會員管理"?(o(),s("div",z,[t[17]||(t[17]=e("h2",{class:"ui header"},"會員管理",-1)),e("div",G,[e("button",{class:"ui basic primary button",onClick:t[3]||(t[3]=(...n)=>a.listMembers&&a.listMembers(...n))},t[15]||(t[15]=[e("i",{class:"users icon"},null,-1),c("列出所有會員")]))]),i.members.length>0?(o(),s("table",H,[t[16]||(t[16]=e("thead",null,[e("tr",null,[e("th",null,"姓名"),e("th",null,"電子郵件")])],-1)),e("tbody",null,[(o(!0),s(f,null,k(i.members,n=>(o(),s("tr",null,[e("td",null,d(n.fullname),1),e("td",null,d(n.email),1)]))),256))])])):P("",!0)])):P("",!0),i.action==="理監事會"?(o(),s("div",J,[t[26]||(t[26]=e("h2",{class:"ui header"},"理監事會",-1)),e("div",K,[e("table",null,[t[20]||(t[20]=e("thead",null,[e("tr",null,[e("th",null,"姓名"),e("th",null,"職位"),e("th",null,"電子郵件"),e("th",null,"動作")])],-1)),e("tbody",null,[(o(!0),s(f,null,k(i.supervisors,n=>(o(),s("tr",null,[e("td",null,d(n.fullname),1),e("td",null,d(n.role),1),e("td",null,d(n.email),1),e("td",null,[e("div",Q,[e("button",{class:"ui basic primary button",onClick:v=>a.editSupervisor(n)},t[18]||(t[18]=[e("i",{class:"edit icon"},null,-1),c("編輯")]),8,W),e("button",{class:"ui basic red button",onClick:v=>a.deleteSupervisor(n)},t[19]||(t[19]=[e("i",{class:"trash icon"},null,-1),c("刪除")]),8,X)])])]))),256))])])]),e("div",Y,[e("div",Z,[t[21]||(t[21]=e("label",null,"姓名",-1)),e("div",$,[u(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=n=>i.newName=n),placeholder:"請輸入理事會成員姓名"},null,512),[[m,i.newName]])])]),e("div",ee,[t[22]||(t[22]=e("label",null,"職位",-1)),e("div",te,[u(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=n=>i.newRole=n),placeholder:"請輸入理事會成員職位"},null,512),[[m,i.newRole]])])]),e("div",ne,[t[23]||(t[23]=e("label",null,"電子郵件",-1)),e("div",ie,[u(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=n=>i.newEmail=n),placeholder:"請輸入理事會成員電子郵件"},null,512),[[m,i.newEmail]])])]),i.editMode?(o(),s("button",{key:1,class:"ui basic green button",onClick:t[8]||(t[8]=n=>a.updateSupervisor(i.currentSupervisor))},t[25]||(t[25]=[e("i",{class:"save icon"},null,-1),c("更新")]))):(o(),s("button",{key:0,class:"ui basic green button",onClick:t[7]||(t[7]=n=>a.addSupervisor(i.newName,i.newRole,i.newEmail))},t[24]||(t[24]=[e("i",{class:"user add icon"},null,-1),c("新增")])))])])):P("",!0),i.action==="專案管理"?(o(),s("div",le,[t[36]||(t[36]=e("h2",{class:"ui header"},"專案管理",-1)),u(e("table",se,[t[30]||(t[30]=e("thead",null,[e("tr",null,[e("th",null,"全名"),e("th",null,"主要類別"),e("th",null,"維護者"),e("th",null,"電子郵件信箱"),e("th",{class:"description"},"描述"),e("th",null,"動作")])],-1)),e("tbody",null,[(o(!0),s(f,null,k(i.projects,n=>(o(),s("tr",{key:n.id},[e("td",null,[e("a",{href:n.website,target:"_blank",rel:"noopener noreferrer"},[t[27]||(t[27]=e("i",{class:"globe icon"},null,-1)),c(d(n.full_name),1)],8,oe)]),e("td",null,d(n.main_category),1),e("td",null,d(n.maintainer),1),e("td",null,d(n.maintainer_email),1),e("td",re,d(n.description),1),e("td",null,[e("div",ae,[e("button",{class:"ui basic primary button",onClick:v=>a.editProject(n)},t[28]||(t[28]=[e("i",{class:"edit icon"},null,-1),c("編輯")]),8,de),e("button",{class:"ui basic red button",onClick:v=>a.deleteProject(n)},t[29]||(t[29]=[e("i",{class:"trash icon"},null,-1),c("刪除")]),8,ue)])])]))),128))])],512),[[A,!i.editMode]]),e("div",ce,[e("div",me,[t[31]||(t[31]=e("label",null,"全名",-1)),e("div",we,[u(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=n=>i.newProjectName=n),placeholder:"請輸入專案全名"},null,512),[[m,i.newProjectName]])])]),e("div",ve,[t[32]||(t[32]=e("label",null,"主要類別",-1)),e("div",be,[u(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=n=>i.newProjectMainCategory=n),placeholder:"請輸入專案主要類別"},null,512),[[m,i.newProjectMainCategory]])])]),e("div",je,[t[33]||(t[33]=e("label",null,"維護者",-1)),e("div",pe,[u(e("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=n=>i.newProjectMaintainer=n),placeholder:"請輸入專案維護者"},null,512),[[m,i.newProjectMaintainer]])])]),e("div",he,[t[34]||(t[34]=e("label",null,"電子郵件信箱",-1)),e("div",Pe,[u(e("input",{type:"text","onUpdate:modelValue":t[12]||(t[12]=n=>i.newProjectMaintainerEmail=n),placeholder:"請輸入專案維護者電子郵件"},null,512),[[m,i.newProjectMaintainerEmail]])])]),e("div",ye,[t[35]||(t[35]=e("label",null,"描述",-1)),e("div",fe,[u(e("input",{type:"text","onUpdate:modelValue":t[13]||(t[13]=n=>i.newProjectDescription=n),placeholder:"請輸入專案描述"},null,512),[[m,i.newProjectDescription]])])]),e("button",{class:"ui basic green button",onClick:t[14]||(t[14]=n=>i.editMode?a.updateProject(i.currentProject):a.addProject())},[i.editMode?(o(),s("i",Me)):(o(),s("i",ke)),i.editMode?(o(),s("span",_e,"更新")):(o(),s("span",ge,"新增"))])])])):P("",!0)])):(o(),s("div",Ce,t[38]||(t[38]=[e("h2",{class:"ui header"},"請先登入管理員帳號",-1)])))}const Se=F(T,[["render",Ne],["__scopeId","data-v-26ff779e"]]);export{Se as default};
