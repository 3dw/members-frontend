import{U as q,f as u,E as v,O as f,H as c,S as I,a2 as w,c as n,a as o,e as k,w as l,v as y,d as b,K as p,b as h,o as i,_ as F}from"./index-D0NF5lES.js";const V=q({name:"CreateFaqView",props:{uid:{type:String,required:!0}},setup(){const t=w(),e=u({id:"",category:"",question:"",answer:""}),d=u(!1);return v(async()=>{try{const s=t.params.id,r=(await f.get("https://members-backend.alearn13994229.workers.dev/api/Faq")).data;console.log(s),console.log(r);const a=r.find(m=>m.id===parseInt(s));a&&(e.value=a)}catch(s){console.error("獲取FAQ資料失敗:",s)}}),{faqItem:e,uploading:d}},methods:{toggleLogin(){this.$emit("toggleLogin")},async createFaq(){if(this.faqItem.category===""){alert("請選擇類別");return}if(this.faqItem.question===""){alert("請輸入問題");return}if(this.faqItem.answer===""){alert("請輸入回答");return}try{this.uploading=!0,await f.post("https://members-backend.alearn13994229.workers.dev/create/faq",{category:this.faqItem.category,question:this.faqItem.question,answer:this.faqItem.answer,links:"[]"}).then(()=>{this.uploading=!1,alert("上傳成功")}).catch(e=>{this.uploading=!1,console.error("新增FAQ失敗:",e),alert("上傳失敗")})}catch(e){this.uploading=!1,console.error("新增FAQ失敗:",e),alert("上傳失敗");return}const t={date:new Date().toISOString(),uid:this.uid,text:`新增FAQ：${this.faqItem.question}`,faqId:this.faqItem.id};c(I,t).then(()=>{console.log("新增成功"),this.goBack()})},goBack(){this.$router.push("/faq")}}}),C={class:"faq-container"},B={class:"ui container relative"},$={key:0,class:"ui active inverted dimmer"},S={key:1,class:"ui form"},A={class:"field"},L={class:"field"},N={class:"field"};function Q(t,e,d,s,g,r){return i(),n("div",C,[o("div",B,[t.uploading?(i(),n("div",$,e[6]||(e[6]=[o("div",{class:"ui loader"},null,-1)]))):k("",!0),t.uid?(i(),n("div",S,[o("div",A,[e[8]||(e[8]=o("label",null,"類別：",-1)),l(o("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.faqItem.category=a)},e[7]||(e[7]=[b('<option value="" data-v-7f5aa981>請選擇類別</option><option value="起步" data-v-7f5aa981>起步</option><option value="計畫" data-v-7f5aa981>計畫</option><option value="支持" data-v-7f5aa981>支持</option><option value="資源" data-v-7f5aa981>資源</option><option value="其他" data-v-7f5aa981>其他</option>',6)]),512),[[y,t.faqItem.category]])]),o("div",L,[e[9]||(e[9]=o("label",null,"問題：",-1)),l(o("textarea",{"onUpdate:modelValue":e[1]||(e[1]=a=>t.faqItem.question=a),rows:"3"},null,512),[[p,t.faqItem.question]])]),o("div",N,[e[10]||(e[10]=o("label",null,"回答",-1)),l(o("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>t.faqItem.answer=a),rows:"20"},null,512),[[p,t.faqItem.answer]])]),o("button",{class:"ui button primary",type:"button",onClick:e[3]||(e[3]=(...a)=>t.createFaq&&t.createFaq(...a))},"上傳"),o("button",{class:"ui button",onClick:e[4]||(e[4]=(...a)=>t.goBack&&t.goBack(...a))},"返回")])):(i(),n("button",{key:2,class:"ui button orange",type:"button",onClick:e[5]||(e[5]=(...a)=>t.toggleLogin&&t.toggleLogin(...a))},e[11]||(e[11]=[o("i",{class:"user icon"},null,-1),h("請先登人以創建問答")])))])])}const M=F(V,[["render",Q],["__scopeId","data-v-7f5aa981"]]);export{M as default};
