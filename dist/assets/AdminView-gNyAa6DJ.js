import{r,o as q,a as g,s as b,k as j,l as B,m as p,q as _,u as C,d as s,g as t,f as m,F as f,i as k,h as P,w as c,v as w,x as O,j as o,t as u,_ as A}from"./index-CcPAxhM-.js";const F={props:{uid:{type:String,required:!0},user:{type:Object,required:!0}},setup(){const l=r([]),e=r("理事會"),a=r(""),i=r(""),M=r(""),d=r([]),n=r(""),v=r([]),x=r(""),N=r(""),S=r(""),E=r(""),V=r(""),D=r(!1),R=r({}),U=r({});return q(()=>{g(C,y=>{const h=y.val();console.log(h),l.value=Object.values(h)}),g(_,y=>{const h=y.val();console.log(h),v.value=Object.values(h)})}),{supervisors:l,action:e,newName:a,newRole:i,newEmail:M,members:d,password:n,projects:v,newProjectName:x,newProjectMainCategory:N,newProjectMaintainer:S,newProjectMaintainerEmail:E,newProjectDescription:V,editMode:D,currentProject:R,currentSupervisor:U}},methods:{addSupervisor(l,e,a){const i=this.supervisors.length;b(j(p,`supervisors/${i}`),{id:i,fullname:l,role:e,email:a})},listMembers(){const l=window.prompt("請輸入密碼");l&&B.post("https://members-backend.alearn13994229.workers.dev/get_user_list",{uid:this.uid,password:l}).then(e=>{this.members=e.data}).catch(e=>{console.error("讀取會員資料時出錯",e)})},addProject(){const l=this.projects.length;b(j(p,`projects/${l}`),{id:l,full_name:this.newProjectName,main_category:this.newProjectMainCategory,maintainer:this.newProjectMaintainer,maintainer_email:this.newProjectMaintainerEmail,description:this.newProjectDescription})},editProject(l){this.newProjectName=l.full_name,this.newProjectMainCategory=l.main_category,this.newProjectMaintainer=l.maintainer,this.newProjectMaintainerEmail=l.maintainer_email,this.newProjectDescription=l.description,this.editMode=!0,this.currentProject=l},updateProject(l){b(j(p,`projects/${l.id}`),{id:l.id,full_name:this.newProjectName,main_category:this.newProjectMainCategory,maintainer:this.newProjectMaintainer,maintainer_email:this.newProjectMaintainerEmail,description:this.newProjectDescription}).then(()=>{window.alert("更新成功"),this.editMode=!1}).catch(e=>{console.error("更新失敗",e),window.alert("更新失敗")})},deleteProject(l){if(window.confirm("確定要刪除嗎？")){const e=this.projects.filter(a=>a.id!==l.id);b(_,e).then(()=>{window.alert("刪除成功")}).catch(a=>{console.error("刪除失敗",a),window.alert("刪除失敗")})}},editSupervisor(l){this.newName=l.fullname,this.newRole=l.role,this.newEmail=l.email,this.editMode=!0,this.currentSupervisor=l},updateSupervisor(l){b(j(p,`supervisors/${l.id}`),{id:l.id,fullname:this.newName,role:this.newRole,email:this.newEmail})},deleteSupervisor(l){const e=this.supervisors.filter(a=>a.id!==l.id);b(C,e).then(()=>{window.alert("刪除成功")}).catch(a=>{console.error("刪除失敗",a),window.alert("刪除失敗")})}}},T={key:0,class:"ui segment container"},I={class:"ui menu"},L={key:0,class:"ui segment"},z={class:"ui segment"},G={key:0,class:"ui celled compact table"},H={key:1,class:"ui segment"},J={class:"ui celled compact table"},K={class:"ui vertical buttons"},Q=["onClick"],W=["onClick"],X={class:"ui form"},Y={class:"ui field"},Z={class:"ui input"},$={class:"ui field"},tt={class:"ui input"},et={class:"ui field"},nt={class:"ui input"},it={key:2,class:"ui segment"},lt={class:"ui celled stackable table"},st=["href"],ot={class:"description"},rt={class:"ui vertical buttons"},at=["onClick"],dt=["onClick"],ut={class:"ui form"},ct={class:"ui field"},mt={class:"ui input"},wt={class:"ui field"},vt={class:"ui input"},bt={class:"ui field"},ht={class:"ui input"},jt={class:"ui field"},pt={class:"ui input"},Pt={class:"ui field"},yt={class:"ui input"},ft={key:0,class:"plus icon"},kt={key:1,class:"save icon"},Mt={key:2},gt={key:3},_t={key:1,class:"ui segment"};function Ct(l,e,a,i,M,d){return a.uid&&a.user&&a.user.isAdmin?(o(),s("main",T,[e[37]||(e[37]=t("h1",{class:"ui header"},"管理員系統",-1)),t("div",I,[t("button",{class:"item",onClick:e[0]||(e[0]=n=>i.action="會員管理")},"會員管理"),t("button",{class:"item",onClick:e[1]||(e[1]=n=>i.action="理監事會")},"理監事會"),t("button",{class:"item",onClick:e[2]||(e[2]=n=>i.action="專案管理")},"專案管理")]),i.action==="會員管理"?(o(),s("div",L,[e[17]||(e[17]=t("h2",{class:"ui header"},"會員管理",-1)),t("div",z,[t("button",{class:"ui basic primary button",onClick:e[3]||(e[3]=(...n)=>d.listMembers&&d.listMembers(...n))},e[15]||(e[15]=[t("i",{class:"users icon"},null,-1),m("列出所有會員")]))]),i.members.length>0?(o(),s("table",G,[e[16]||(e[16]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"電子郵件")])],-1)),t("tbody",null,[(o(!0),s(f,null,k(i.members,n=>(o(),s("tr",null,[t("td",null,u(n.fullname),1),t("td",null,u(n.email),1)]))),256))])])):P("",!0)])):P("",!0),i.action==="理監事會"?(o(),s("div",H,[e[26]||(e[26]=t("h2",{class:"ui header"},"理監事會",-1)),t("table",J,[e[20]||(e[20]=t("thead",null,[t("tr",null,[t("th",null,"姓名"),t("th",null,"職位"),t("th",null,"電子郵件"),t("th",null,"動作")])],-1)),t("tbody",null,[(o(!0),s(f,null,k(i.supervisors,n=>(o(),s("tr",null,[t("td",null,u(n.fullname),1),t("td",null,u(n.role),1),t("td",null,u(n.email),1),t("td",null,[t("div",K,[t("button",{class:"ui basic primary button",onClick:v=>d.editSupervisor(n)},e[18]||(e[18]=[t("i",{class:"edit icon"},null,-1),m("編輯")]),8,Q),t("button",{class:"ui basic red button",onClick:v=>d.deleteSupervisor(n)},e[19]||(e[19]=[t("i",{class:"trash icon"},null,-1),m("刪除")]),8,W)])])]))),256))])]),t("div",X,[t("div",Y,[e[21]||(e[21]=t("label",null,"姓名",-1)),t("div",Z,[c(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=n=>i.newName=n),placeholder:"請輸入理事會成員姓名"},null,512),[[w,i.newName]])])]),t("div",$,[e[22]||(e[22]=t("label",null,"職位",-1)),t("div",tt,[c(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=n=>i.newRole=n),placeholder:"請輸入理事會成員職位"},null,512),[[w,i.newRole]])])]),t("div",et,[e[23]||(e[23]=t("label",null,"電子郵件",-1)),t("div",nt,[c(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=n=>i.newEmail=n),placeholder:"請輸入理事會成員電子郵件"},null,512),[[w,i.newEmail]])])]),i.editMode?(o(),s("button",{key:1,class:"ui basic green button",onClick:e[8]||(e[8]=n=>d.updateSupervisor(i.currentSupervisor))},e[25]||(e[25]=[t("i",{class:"save icon"},null,-1),m("更新")]))):(o(),s("button",{key:0,class:"ui basic green button",onClick:e[7]||(e[7]=n=>d.addSupervisor(i.newName,i.newRole,i.newEmail))},e[24]||(e[24]=[t("i",{class:"user add icon"},null,-1),m("新增")])))])])):P("",!0),i.action==="專案管理"?(o(),s("div",it,[e[36]||(e[36]=t("h2",{class:"ui header"},"專案管理",-1)),c(t("table",lt,[e[30]||(e[30]=t("thead",null,[t("tr",null,[t("th",null,"全名"),t("th",null,"主要類別"),t("th",null,"維護者"),t("th",null,"電子郵件信箱"),t("th",{class:"description"},"描述"),t("th",null,"動作")])],-1)),t("tbody",null,[(o(!0),s(f,null,k(i.projects,n=>(o(),s("tr",{key:n.id},[t("td",null,[t("a",{href:n.website,target:"_blank",rel:"noopener noreferrer"},[e[27]||(e[27]=t("i",{class:"globe icon"},null,-1)),m(u(n.full_name),1)],8,st)]),t("td",null,u(n.main_category),1),t("td",null,u(n.maintainer),1),t("td",null,u(n.maintainer_email),1),t("td",ot,u(n.description),1),t("td",null,[t("div",rt,[t("button",{class:"ui basic primary button",onClick:v=>d.editProject(n)},e[28]||(e[28]=[t("i",{class:"edit icon"},null,-1),m("編輯")]),8,at),t("button",{class:"ui basic red button",onClick:v=>d.deleteProject(n)},e[29]||(e[29]=[t("i",{class:"trash icon"},null,-1),m("刪除")]),8,dt)])])]))),128))])],512),[[O,!i.editMode]]),t("div",ut,[t("div",ct,[e[31]||(e[31]=t("label",null,"全名",-1)),t("div",mt,[c(t("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=n=>i.newProjectName=n),placeholder:"請輸入專案全名"},null,512),[[w,i.newProjectName]])])]),t("div",wt,[e[32]||(e[32]=t("label",null,"主要類別",-1)),t("div",vt,[c(t("input",{type:"text","onUpdate:modelValue":e[10]||(e[10]=n=>i.newProjectMainCategory=n),placeholder:"請輸入專案主要類別"},null,512),[[w,i.newProjectMainCategory]])])]),t("div",bt,[e[33]||(e[33]=t("label",null,"維護者",-1)),t("div",ht,[c(t("input",{type:"text","onUpdate:modelValue":e[11]||(e[11]=n=>i.newProjectMaintainer=n),placeholder:"請輸入專案維護者"},null,512),[[w,i.newProjectMaintainer]])])]),t("div",jt,[e[34]||(e[34]=t("label",null,"電子郵件信箱",-1)),t("div",pt,[c(t("input",{type:"text","onUpdate:modelValue":e[12]||(e[12]=n=>i.newProjectMaintainerEmail=n),placeholder:"請輸入專案維護者電子郵件"},null,512),[[w,i.newProjectMaintainerEmail]])])]),t("div",Pt,[e[35]||(e[35]=t("label",null,"描述",-1)),t("div",yt,[c(t("input",{type:"text","onUpdate:modelValue":e[13]||(e[13]=n=>i.newProjectDescription=n),placeholder:"請輸入專案描述"},null,512),[[w,i.newProjectDescription]])])]),t("button",{class:"ui basic green button",onClick:e[14]||(e[14]=n=>i.editMode?d.updateProject(i.currentProject):d.addProject())},[i.editMode?(o(),s("i",kt)):(o(),s("i",ft)),i.editMode?(o(),s("span",gt,"更新")):(o(),s("span",Mt,"新增"))])])])):P("",!0)])):(o(),s("div",_t,e[38]||(e[38]=[t("h2",{class:"ui header"},"請先登入管理員帳號",-1)])))}const Nt=A(F,[["render",Ct],["__scopeId","data-v-83d187de"]]);export{Nt as default};
