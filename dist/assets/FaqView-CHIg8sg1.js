import{d as m,r as c,b as y,e as u,c as n,a as s,w as g,v as b,F as h,f as p,g as k,o as l,t as f,h as w,i as q,_ as v}from"./index-D4db0O7_.js";const L=m({name:"FaqView",setup(){const e=c([]),t=c(["全部","起步","計畫","支持","資源","其他"]),r=c(""),a=c("全部");return y(async()=>{try{const d=await u.get("https://members-backend.alearn13994229.workers.dev/api/Faq");e.value=d.data}catch(d){console.error("獲取FAQ資料失敗:",d)}}),{faqItems:e,categories:t,searchKeyword:r,selectedCategory:a}},computed:{sortedFaqItems(){return this.faqItems.slice().sort((e,t)=>this.categories.indexOf(e.category)-this.categories.indexOf(t.category))},filteredAndSortedFaqItems(){const e=this.searchKeyword.toLowerCase().trim();let t=this.faqItems;return this.selectedCategory!=="全部"&&(t=t.filter(r=>r.category===this.selectedCategory)),e&&(t=t.filter(r=>r.category.toLowerCase().includes(e)||r.question.toLowerCase().includes(e)||r.answer.toLowerCase().includes(e))),t.sort((r,a)=>this.categories.indexOf(r.category)-this.categories.indexOf(a.category))}},methods:{fetchFaq(){this.faqItems=[],u.get("https://members-backend.alearn13994229.workers.dev/api/Faq").then(e=>{this.faqItems=e.data}).catch(e=>{console.error("獲取FAQ資料失敗:",e)})},parseLinks(e){return console.log(e),JSON.parse(e)},parseAnswer(e){return console.log(e),e.replace(/\\n/g,`
`)},editFaq(e){console.log(e),this.$router.push(`/edit_faq/${e}`)},deleteFaq(e){console.log(e)},deleteLink(e,t){console.log(e,t),confirm("確定要刪除此連結嗎？")&&(console.log("刪除"),u.delete(`https://members-backend.alearn13994229.workers.dev/delete/faq/${e}/link/${t}`).then(()=>{window.alert("刪除成功"),console.log("刪除成功"),this.fetchFaq()}).catch(r=>{window.alert("刪除失敗"),console.error("刪除失敗:",r)}))},escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},highlightText(e){if(!this.searchKeyword.trim())return this.escapeHtml(e);const t=this.escapeHtml(e),r=this.escapeHtml(this.searchKeyword.toLowerCase().trim()),a=new RegExp(`(${r})`,"gi");return t.replace(a,'<span class="highlight">$1</span>')}}}),C={class:"faq-container"},F={class:"ui container"},T={class:"ui form"},$={class:"two stackable fields"},_={class:"field",style:{"max-width":"150px"}},H=["value"],I={class:"field"},M={class:"ui icon input"},V={class:"ui celled table"},A=["innerHTML"],K=["innerHTML"],x=["innerHTML"],O={class:"answer-cell"},S={key:0,class:"ui bulleted list"},N=["href"],B=["onClick"],D=["onClick"];function E(e,t,r,a,d,Q){return l(),n("div",C,[t[9]||(t[9]=s("h2",{class:"ui header"},"常見問題",-1)),s("div",F,[s("form",T,[s("div",$,[s("div",_,[t[2]||(t[2]=s("label",null,"類別篩選",-1)),g(s("select",{class:"ui dropdown","onUpdate:modelValue":t[0]||(t[0]=o=>e.selectedCategory=o)},[(l(!0),n(h,null,p(e.categories,o=>(l(),n("option",{value:o},f(o),9,H))),256))],512),[[b,e.selectedCategory]])]),s("div",I,[t[4]||(t[4]=s("label",null,"關鍵字篩選",-1)),s("div",M,[g(s("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=o=>e.searchKeyword=o),placeholder:"搜尋常見問題..."},null,512),[[k,e.searchKeyword]]),t[3]||(t[3]=s("i",{class:"search icon"},null,-1))])])])]),s("table",V,[t[8]||(t[8]=s("thead",null,[s("tr",null,[s("th",null,"類別"),s("th",null,"問題"),s("th",null,"回答"),s("th",null,"相關連結"),s("th",null,"操作")])],-1)),s("tbody",null,[(l(!0),n(h,null,p(e.filteredAndSortedFaqItems,o=>(l(),n("tr",{key:o.id},[s("td",{innerHTML:e.highlightText(o.category)},null,8,A),s("td",{innerHTML:e.highlightText(o.question)},null,8,K),s("td",{class:"answer-cell",innerHTML:e.highlightText(e.parseAnswer(o.answer))},null,8,x),s("td",O,[o.links&&e.parseLinks(o.links).length>0?(l(),n("div",S,[(l(!0),n(h,null,p(e.parseLinks(o.links),i=>(l(),n("div",{class:"item",key:i.h},[s("a",{href:i.h,target:"_blank",rel:"noopener noreferrer"},f(i.t),9,N),t[6]||(t[6]=s("br",null,null,-1)),s("button",{class:"ui button mini circular red icon",type:"button",onClick:U=>e.deleteLink(o.id,i.h)},t[5]||(t[5]=[s("i",{class:"trash icon"},null,-1),w("刪除")]),8,B)]))),128))])):q("",!0)]),s("td",null,[s("button",{class:"ui button primary",type:"button",onClick:i=>e.editFaq(o.id)},t[7]||(t[7]=[s("i",{class:"pencil icon"},null,-1),w("編輯")]),8,D)])]))),128))])])])])}const R=v(L,[["render",E],["__scopeId","data-v-3df8b48d"]]);export{R as default};
