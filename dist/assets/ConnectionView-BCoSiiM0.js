import{d as L,r as m,b as U,e as x,o as R,a as S,aa as V,k as l,g as i,h as s,F as z,j as M,m as P,ab as D,t as n,i as r,a5 as E,V as $,_ as j}from"./index-B5XOrBgH.js";const B={class:"connection-view"},I={class:"circle-container"},T={class:"seat-number"},A=["onClick"],F=["src"],N={class:"user-name"},O={class:"stats"},W={class:"stat-item"},q={class:"stat-number"},G={class:"stat-item"},H={class:"stat-number"},J={class:"profile-content"},K={class:"profile-header"},Q=["src"],X={class:"profile-info"},Y={class:"profile-name"},Z={key:0,class:"profile-detail"},ss={class:"detail-value"},es={key:1,class:"profile-detail"},ts={class:"detail-value"},as={key:2,class:"profile-detail"},os={class:"detail-value"},ls={class:"profile-detail"},is={class:"detail-value"},ns=L({__name:"ConnectionView",setup(rs){const v=m({}),d=m(50),h=async()=>{try{const t=await $.get("https://members-backend.alearn13994229.workers.dev/count_members");console.log("API response:",t.data),d.value=t.data.total,console.log("Total seats set to:",d.value)}catch(t){console.error("Error fetching total seats:",t)}},b=t=>{const o=(()=>{const u=window.innerWidth;return u>1200?350:u>900?300:u>700?250:u>500?200:u>350?150:130})(),f=(t-1)*(360/d.value)*(Math.PI/180),w=o*Math.cos(f),C=o*Math.sin(f);return{transform:`translate(${w}px, ${C}px)`}},g=U(x,"users");let _=null;R(async()=>{await h(),_=S(g,t=>{const e=t.val();e&&(v.value=e,console.log("Users data updated:",e))},t=>{console.error("Error fetching users:",t)})}),V(()=>{_&&_()});const c=t=>v.value&&Object.values(v.value)[t-1]||null,a=m(null),k=t=>{a.value=t},p=()=>{a.value=null},y=t=>t?new Date(t).toLocaleDateString("zh-TW",{year:"numeric",month:"long",day:"numeric"}):"未知";return(t,e)=>(l(),i("div",B,[e[8]||(e[8]=s("div",{class:"header"},[s("h1",{class:"title"},"接力顯示板"),s("p",{class:"subtitle"},"即時顯示成員已認證狀態")],-1)),s("div",I,[(l(!0),i(z,null,M(d.value,o=>(l(),i("div",{class:P(["seat",{occupied:c(o)}]),key:o,style:D(b(o))},[s("div",T,n(o),1),c(o)?(l(),i("div",{key:0,class:"user-info",onClick:f=>k(c(o))},[c(o).photoURL?(l(),i("img",{key:0,class:"user-avatar",src:c(o).photoURL},null,8,F)):r("",!0),s("div",N,n(c(o).name||"訪客"),1)],8,A)):r("",!0)],6))),128))]),s("div",O,[s("div",W,[s("div",q,n(d.value),1),e[0]||(e[0]=s("div",{class:"stat-label"},"會員總數",-1)),e[1]||(e[1]=s("div",{class:"stat-accent"},null,-1))]),s("div",G,[s("div",H,n(Object.keys(v.value).length),1),e[2]||(e[2]=s("div",{class:"stat-label"},"認證成員",-1)),e[3]||(e[3]=s("div",{class:"stat-accent"},null,-1))])]),a.value?(l(),i("div",{key:0,class:"profile-modal",onClick:E(p,["self"])},[s("div",J,[s("div",K,[a.value.photoURL?(l(),i("img",{key:0,class:"profile-avatar",src:a.value.photoURL},null,8,Q)):r("",!0),s("div",{class:"profile-close",onClick:p},"×")]),s("div",X,[s("h3",Y,n(a.value.name||"訪客"),1),a.value.email?(l(),i("div",Z,[e[4]||(e[4]=s("div",{class:"detail-label"},"Email",-1)),s("div",ss,n(a.value.email),1)])):r("",!0),a.value.organization?(l(),i("div",es,[e[5]||(e[5]=s("div",{class:"detail-label"},"組織",-1)),s("div",ts,n(a.value.organization),1)])):r("",!0),a.value.role?(l(),i("div",as,[e[6]||(e[6]=s("div",{class:"detail-label"},"角色",-1)),s("div",os,n(a.value.role),1)])):r("",!0),s("div",ls,[e[7]||(e[7]=s("div",{class:"detail-label"},"加入時間",-1)),s("div",is,n(y(a.value.createdAt)),1)])])])])):r("",!0)]))}}),ds=j(ns,[["__scopeId","data-v-2acbb494"]]);export{ds as default};
