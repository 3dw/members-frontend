import{C as q,r as u,o as v,l as p,p as c,y as I,O as w,d as n,f as a,i as y,w as l,J as k,e as b,v as f,h,j as i,_ as F}from"./index-D2iDaD51.js";const C=q({name:"CreateFaqView",props:{uid:{type:String,required:!0}},setup(){const t=w(),e=u({id:"",category:"",question:"",answer:""}),d=u(!1);return v(async()=>{try{const s=t.params.id,r=(await p.get("https://members-backend.alearn13994229.workers.dev/api/Faq")).data;console.log(s),console.log(r);const o=r.find(m=>m.id===parseInt(s));o&&(e.value=o)}catch(s){console.error("獲取FAQ資料失敗:",s)}}),{faqItem:e,uploading:d}},methods:{toggleLogin(){this.$emit("toggleLogin")},async createFaq(){if(this.faqItem.category===""){alert("請選擇類別");return}if(this.faqItem.question===""){alert("請輸入問題");return}if(this.faqItem.answer===""){alert("請輸入回答");return}try{this.uploading=!0,await p.post("https://members-backend.alearn13994229.workers.dev/create/faq",{category:this.faqItem.category,question:this.faqItem.question,answer:this.faqItem.answer,links:"[]"}).then(()=>{this.uploading=!1,alert("上傳成功")}).catch(e=>{this.uploading=!1,console.error("新增FAQ失敗:",e),alert("上傳失敗")})}catch(e){this.uploading=!1,console.error("新增FAQ失敗:",e),alert("上傳失敗");return}const t={date:new Date().toISOString(),uid:this.uid,text:`新增FAQ：${this.faqItem.question}`,faqId:this.faqItem.id};c(I,t).then(()=>{console.log("新增成功"),this.goBack()})},goBack(){this.$router.push("/faq")}}}),V={class:"faq-container"},B={class:"ui container relative"},$={key:0,class:"ui active inverted dimmer"},S={key:1,class:"ui form"},A={class:"field"},L={class:"field"},N={class:"field"};function Q(t,e,d,s,g,r){return i(),n("div",V,[a("div",B,[t.uploading?(i(),n("div",$,e[6]||(e[6]=[a("div",{class:"ui loader"},null,-1)]))):y("",!0),t.uid?(i(),n("div",S,[a("div",A,[e[8]||(e[8]=a("label",null,"類別：",-1)),l(a("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.faqItem.category=o)},e[7]||(e[7]=[b('<option value="" data-v-c6284501>請選擇類別</option><option value="起步" data-v-c6284501>起步</option><option value="計畫" data-v-c6284501>計畫</option><option value="支持" data-v-c6284501>支持</option><option value="資源" data-v-c6284501>資源</option><option value="其他" data-v-c6284501>其他</option>',6)]),512),[[k,t.faqItem.category]])]),a("div",L,[e[9]||(e[9]=a("label",null,"問題：",-1)),l(a("textarea",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.faqItem.question=o),rows:"3"},null,512),[[f,t.faqItem.question]])]),a("div",N,[e[10]||(e[10]=a("label",null,"回答",-1)),l(a("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.faqItem.answer=o),rows:"20"},null,512),[[f,t.faqItem.answer]])]),a("button",{class:"ui button primary",type:"button",onClick:e[3]||(e[3]=(...o)=>t.createFaq&&t.createFaq(...o))},"上傳"),a("button",{class:"ui button",onClick:e[4]||(e[4]=(...o)=>t.goBack&&t.goBack(...o))},"返回")])):(i(),n("button",{key:2,class:"ui button orange",type:"button",onClick:e[5]||(e[5]=(...o)=>t.toggleLogin&&t.toggleLogin(...o))},e[11]||(e[11]=[a("i",{class:"user icon"},null,-1),h("請先登人以創建問答")])))])])}const U=F(C,[["render",Q],["__scopeId","data-v-c6284501"]]);export{U as default};
