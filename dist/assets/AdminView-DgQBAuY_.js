import{f as r,E as O,G as g,M as v,N as j,O as B,P as p,Q as _,R as C,c as s,a as e,b as m,F as y,r as k,e as P,w as c,K as w,J as q,o,t as u,_ as A}from"./index-DUjaasE5.js";const F={props:{uid:{type:String,required:!0},user:{type:Object,required:!0}},setup(){const l=r([]),t=r("理事會"),a=r(""),i=r(""),M=r(""),d=r([]),n=r(""),b=r([]),N=r(""),S=r(""),x=r(""),E=r(""),V=r(""),D=r(!1),R=r({}),U=r({});return O(()=>{g(C,f=>{const h=f.val();console.log(h),l.value=Object.values(h)}),g(_,f=>{const h=f.val();console.log(h),b.value=Object.values(h)})}),{supervisors:l,action:t,newName:a,newRole:i,newEmail:M,members:d,password:n,projects:b,newProjectName:N,newProjectMainCategory:S,newProjectMaintainer:x,newProjectMaintainerEmail:E,newProjectDescription:V,editMode:D,currentProject:R,currentSupervisor:U}},methods:{addSupervisor(l,t,a){const i=this.supervisors.length;v(j(p,`supervisors/${i}`),{id:i,fullname:l,role:t,email:a})},listMembers(){const l=window.prompt("請輸入密碼");l&&B.post("https://members-backend.alearn13994229.workers.dev/get_user_list",{uid:this.uid,password:l}).then(t=>{this.members=t.data}).catch(t=>{console.error("讀取會員資料時出錯",t)})},addProject(){const l=this.projects.length;v(j(p,`projects/${l}`),{id:l,full_name:this.newProjectName,main_category:this.newProjectMainCategory,maintainer:this.newProjectMaintainer,maintainer_email:this.newProjectMaintainerEmail,description:this.newProjectDescription})},editProject(l){this.newProjectName=l.full_name,this.newProjectMainCategory=l.main_category,this.newProjectMaintainer=l.maintainer,this.newProjectMaintainerEmail=l.maintainer_email,this.newProjectDescription=l.description,this.editMode=!0,this.currentProject=l},updateProject(l){v(j(p,`projects/${l.id}`),{id:l.id,full_name:this.newProjectName,main_category:this.newProjectMainCategory,maintainer:this.newProjectMaintainer,maintainer_email:this.newProjectMaintainerEmail,description:this.newProjectDescription}).then(()=>{window.alert("更新成功"),this.editMode=!1}).catch(t=>{console.error("更新失敗",t),window.alert("更新失敗")})},deleteProject(l){if(window.confirm("確定要刪除嗎？")){const t=this.projects.filter(a=>a.id!==l.id);v(_,t).then(()=>{window.alert("刪除成功")}).catch(a=>{console.error("刪除失敗",a),window.alert("刪除失敗")})}},editSupervisor(l){this.newName=l.fullname,this.newRole=l.role,this.newEmail=l.email,this.editMode=!0,this.currentSupervisor=l},updateSupervisor(l){v(j(p,`supervisors/${l.id}`),{id:l.id,fullname:this.newName,role:this.newRole,email:this.newEmail}).then(()=>{window.alert("更新成功"),this.editMode=!1}).catch(t=>{console.error("更新失敗",t),window.alert("更新失敗")})},deleteSupervisor(l){const t=this.supervisors.filter(a=>a.id!==l.id);v(C,t).then(()=>{window.alert("刪除成功")}).catch(a=>{console.error("刪除失敗",a),window.alert("刪除失敗")})}}},T={key:0,class:"ui segment container"},G={class:"ui menu"},I={key:0,class:"ui segment"},J={class:"ui segment"},K={key:0,class:"ui celled compact table"},L={key:1,class:"ui segment"},Q={class:"ui celled compact table"},z={class:"ui vertical buttons"},H=["onClick"],W=["onClick"],X={class:"ui form"},Y={class:"ui field"},Z={class:"ui input"},$={class:"ui field"},ee={class:"ui input"},te={class:"ui field"},ne={class:"ui input"},ie={key:2,class:"ui segment"},le={class:"ui celled stackable table"},se=["href"],oe={class:"description"},re={class:"ui vertical buttons"},ae=["onClick"],de=["onClick"],ue={class:"ui form"},ce={class:"ui field"},me={class:"ui input"},we={class:"ui field"},be={class:"ui input"},ve={class:"ui field"},he={class:"ui input"},je={class:"ui field"},pe={class:"ui input"},Pe={class:"ui field"},fe={class:"ui input"},ye={key:0,class:"plus icon"},ke={key:1,class:"save icon"},Me={key:2},ge={key:3},_e={key:1,class:"ui segment"};function Ce(l,t,a,i,M,d){return a.uid&&a.user&&a.user.isAdmin?(o(),s("main",T,[t[37]||(t[37]=e("h1",{class:"ui header"},"管理員系統",-1)),e("div",G,[e("button",{class:"item",onClick:t[0]||(t[0]=n=>i.action="會員管理")},"會員管理"),e("button",{class:"item",onClick:t[1]||(t[1]=n=>i.action="理監事會")},"理監事會"),e("button",{class:"item",onClick:t[2]||(t[2]=n=>i.action="專案管理")},"專案管理")]),i.action==="會員管理"?(o(),s("div",I,[t[17]||(t[17]=e("h2",{class:"ui header"},"會員管理",-1)),e("div",J,[e("button",{class:"ui basic primary button",onClick:t[3]||(t[3]=(...n)=>d.listMembers&&d.listMembers(...n))},t[15]||(t[15]=[e("i",{class:"users icon"},null,-1),m("列出所有會員")]))]),i.members.length>0?(o(),s("table",K,[t[16]||(t[16]=e("thead",null,[e("tr",null,[e("th",null,"姓名"),e("th",null,"電子郵件")])],-1)),e("tbody",null,[(o(!0),s(y,null,k(i.members,n=>(o(),s("tr",null,[e("td",null,u(n.fullname),1),e("td",null,u(n.email),1)]))),256))])])):P("",!0)])):P("",!0),i.action==="理監事會"?(o(),s("div",L,[t[26]||(t[26]=e("h2",{class:"ui header"},"理監事會",-1)),e("table",Q,[t[20]||(t[20]=e("thead",null,[e("tr",null,[e("th",null,"姓名"),e("th",null,"職位"),e("th",null,"電子郵件"),e("th",null,"動作")])],-1)),e("tbody",null,[(o(!0),s(y,null,k(i.supervisors,n=>(o(),s("tr",null,[e("td",null,u(n.fullname),1),e("td",null,u(n.role),1),e("td",null,u(n.email),1),e("td",null,[e("div",z,[e("button",{class:"ui basic primary button",onClick:b=>d.editSupervisor(n)},t[18]||(t[18]=[e("i",{class:"edit icon"},null,-1),m("編輯")]),8,H),e("button",{class:"ui basic red button",onClick:b=>d.deleteSupervisor(n)},t[19]||(t[19]=[e("i",{class:"trash icon"},null,-1),m("刪除")]),8,W)])])]))),256))])]),e("div",X,[e("div",Y,[t[21]||(t[21]=e("label",null,"姓名",-1)),e("div",Z,[c(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=n=>i.newName=n),placeholder:"請輸入理事會成員姓名"},null,512),[[w,i.newName]])])]),e("div",$,[t[22]||(t[22]=e("label",null,"職位",-1)),e("div",ee,[c(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=n=>i.newRole=n),placeholder:"請輸入理事會成員職位"},null,512),[[w,i.newRole]])])]),e("div",te,[t[23]||(t[23]=e("label",null,"電子郵件",-1)),e("div",ne,[c(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=n=>i.newEmail=n),placeholder:"請輸入理事會成員電子郵件"},null,512),[[w,i.newEmail]])])]),i.editMode?(o(),s("button",{key:1,class:"ui basic green button",onClick:t[8]||(t[8]=n=>d.updateSupervisor(i.currentSupervisor))},t[25]||(t[25]=[e("i",{class:"save icon"},null,-1),m("更新")]))):(o(),s("button",{key:0,class:"ui basic green button",onClick:t[7]||(t[7]=n=>d.addSupervisor(i.newName,i.newRole,i.newEmail))},t[24]||(t[24]=[e("i",{class:"user add icon"},null,-1),m("新增")])))])])):P("",!0),i.action==="專案管理"?(o(),s("div",ie,[t[36]||(t[36]=e("h2",{class:"ui header"},"專案管理",-1)),c(e("table",le,[t[30]||(t[30]=e("thead",null,[e("tr",null,[e("th",null,"全名"),e("th",null,"主要類別"),e("th",null,"維護者"),e("th",null,"電子郵件信箱"),e("th",{class:"description"},"描述"),e("th",null,"動作")])],-1)),e("tbody",null,[(o(!0),s(y,null,k(i.projects,n=>(o(),s("tr",{key:n.id},[e("td",null,[e("a",{href:n.website,target:"_blank",rel:"noopener noreferrer"},[t[27]||(t[27]=e("i",{class:"globe icon"},null,-1)),m(u(n.full_name),1)],8,se)]),e("td",null,u(n.main_category),1),e("td",null,u(n.maintainer),1),e("td",null,u(n.maintainer_email),1),e("td",oe,u(n.description),1),e("td",null,[e("div",re,[e("button",{class:"ui basic primary button",onClick:b=>d.editProject(n)},t[28]||(t[28]=[e("i",{class:"edit icon"},null,-1),m("編輯")]),8,ae),e("button",{class:"ui basic red button",onClick:b=>d.deleteProject(n)},t[29]||(t[29]=[e("i",{class:"trash icon"},null,-1),m("刪除")]),8,de)])])]))),128))])],512),[[q,!i.editMode]]),e("div",ue,[e("div",ce,[t[31]||(t[31]=e("label",null,"全名",-1)),e("div",me,[c(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=n=>i.newProjectName=n),placeholder:"請輸入專案全名"},null,512),[[w,i.newProjectName]])])]),e("div",we,[t[32]||(t[32]=e("label",null,"主要類別",-1)),e("div",be,[c(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=n=>i.newProjectMainCategory=n),placeholder:"請輸入專案主要類別"},null,512),[[w,i.newProjectMainCategory]])])]),e("div",ve,[t[33]||(t[33]=e("label",null,"維護者",-1)),e("div",he,[c(e("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=n=>i.newProjectMaintainer=n),placeholder:"請輸入專案維護者"},null,512),[[w,i.newProjectMaintainer]])])]),e("div",je,[t[34]||(t[34]=e("label",null,"電子郵件信箱",-1)),e("div",pe,[c(e("input",{type:"text","onUpdate:modelValue":t[12]||(t[12]=n=>i.newProjectMaintainerEmail=n),placeholder:"請輸入專案維護者電子郵件"},null,512),[[w,i.newProjectMaintainerEmail]])])]),e("div",Pe,[t[35]||(t[35]=e("label",null,"描述",-1)),e("div",fe,[c(e("input",{type:"text","onUpdate:modelValue":t[13]||(t[13]=n=>i.newProjectDescription=n),placeholder:"請輸入專案描述"},null,512),[[w,i.newProjectDescription]])])]),e("button",{class:"ui basic green button",onClick:t[14]||(t[14]=n=>i.editMode?d.updateProject(i.currentProject):d.addProject())},[i.editMode?(o(),s("i",ke)):(o(),s("i",ye)),i.editMode?(o(),s("span",ge,"更新")):(o(),s("span",Me,"新增"))])])])):P("",!0)])):(o(),s("div",_e,t[38]||(t[38]=[e("h2",{class:"ui header"},"請先登入管理員帳號",-1)])))}const Se=A(F,[["render",Ce],["__scopeId","data-v-4367a708"]]);export{Se as default};
